# CVE-2014-0196

The `n_tty_write` function in `drives/tty/n_tty.c` in the Linux kernel through 3.14.3 does not properly manage tty driver access in the "LECHO & !OPOST" case, which allows local users to cause a denial of service (memory corruption and system crash) or gain privilege by triggering a race condition involving read and write operations with long strings.

`dos_poc.c` is for Denial of Service attack and `privilege_escalation_poc.c` is for privilege escalation attack.

I have tested these two pocs in a ubuntu 12.04 running in virtual box. `dos_poc.c` could successfully crash my experiment pc, but `privilege_escalation_poc.c` always failed as ubuntu doesn't export symbols in `/proc/kallsyms`. (As a association, Android doesn't put symbols in `/proc/kallsyms` directly. However, if one want to see them, this command `echo 1 > /proc/sys/kernel/kptr_restrict` helps). I would try these pocs in other distributions or android someday.


